"use strict";(()=>{var e={};e.id=718,e.ids=[718],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3263:e=>{e.exports=import("firebase-admin/app")},2929:e=>{e.exports=import("firebase-admin/firestore")},8066:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{originalPathname:()=>h,patchFetch:()=>p,requestAsyncStorage:()=>u,routeModule:()=>d,serverHooks:()=>l,staticGenerationAsyncStorage:()=>m});var a=s(9303),o=s(8716),n=s(670),i=s(1788),c=e([i]);i=(c.then?(await c)():c)[0];let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/admin/messages/route",pathname:"/api/admin/messages",filename:"route",bundlePath:"app/api/admin/messages/route"},resolvedPagePath:"/Users/tan135/thankyouthomas/app/api/admin/messages/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:u,staticGenerationAsyncStorage:m,serverHooks:l}=d,h="/api/admin/messages/route";function p(){return(0,n.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:m})}r()}catch(e){r(e)}})},1788:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{GET:()=>i});var a=s(7070),o=s(7096),n=e([o]);async function i(e){try{if(!function(e){let t=e.cookies.get("admin-session")?.value;if(!t)return!1;try{let[e,s]=Buffer.from(t,"base64").toString().split(":"),r=parseInt(s),a=Date.now();return e===process.env.ADMIN_USERNAME&&a-r<288e5}catch{return!1}}(e))return a.NextResponse.json({success:!1,error:"Unauthorized"},{status:401});let t=o.db.collection("responses"),s=(await t.get()).docs.map(e=>{let t=e.data();return{id:e.id,message:t.message,name:t.name,email:t.email,isAnonymous:t.isAnonymous,imageUrl:t.imageUrl,isApproved:t.isApproved||!1,createdAt:t.createdAt,submittedAt:t.submittedAt,approvedAt:t.approvedAt,rejectedAt:t.rejectedAt,notificationSent:t.notificationSent||!1}});s.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime());let r=a.NextResponse.json({success:!0,messages:s});return r.headers.set("Cache-Control","no-cache, no-store, must-revalidate"),r.headers.set("Pragma","no-cache"),r.headers.set("Expires","0"),r}catch(t){console.error("Error fetching admin messages:",t);let e=a.NextResponse.json({success:!1,error:"Failed to fetch messages"},{status:500});return e.headers.set("Cache-Control","no-cache, no-store, must-revalidate"),e.headers.set("Pragma","no-cache"),e.headers.set("Expires","0"),e}}o=(n.then?(await n)():n)[0],r()}catch(e){r(e)}})},7096:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.d(t,{db:()=>c});var a=s(3263),o=s(2929),n=e([a,o]);[a,o]=n.then?(await n)():n;let i={type:"service_account",project_id:process.env.FIREBASE_PROJECT_ID,private_key_id:process.env.FIREBASE_PRIVATE_KEY_ID,private_key:process.env.FIREBASE_PRIVATE_KEY?.replace(/\\n/g,"\n"),client_email:process.env.FIREBASE_CLIENT_EMAIL,client_id:process.env.FIREBASE_CLIENT_ID,auth_uri:"https://accounts.google.com/o/oauth2/auth",token_uri:"https://oauth2.googleapis.com/token",auth_provider_x509_cert_url:"https://www.googleapis.com/oauth2/v1/certs",client_x509_cert_url:`https://www.googleapis.com/robot/v1/metadata/x509/${process.env.FIREBASE_CLIENT_EMAIL}`};(0,a.getApps)().length||(0,a.initializeApp)({credential:(0,a.cert)(i)});let c=(0,o.getFirestore)();r()}catch(e){r(e)}})}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[276,972],()=>s(8066));module.exports=r})();