"use strict";(()=>{var e={};e.id=98,e.ids=[98],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3263:e=>{e.exports=import("firebase-admin/app")},2929:e=>{e.exports=import("firebase-admin/firestore")},809:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{originalPathname:()=>g,patchFetch:()=>p,requestAsyncStorage:()=>m,routeModule:()=>c,serverHooks:()=>d,staticGenerationAsyncStorage:()=>l});var a=s(9303),o=s(8716),i=s(670),n=s(68),u=e([n]);n=(u.then?(await u)():u)[0];let c=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/submit-message/route",pathname:"/api/submit-message",filename:"route",bundlePath:"app/api/submit-message/route"},resolvedPagePath:"/Users/tan135/thankyouthomas/app/api/submit-message/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:l,serverHooks:d}=c,g="/api/submit-message/route";function p(){return(0,i.patchFetch)({serverHooks:d,staticGenerationAsyncStorage:l})}r()}catch(e){r(e)}})},68:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{POST:()=>u});var a=s(7070),o=s(7096),i=s(2929),n=e([o,i]);async function u(e){try{let t;let s=await e.formData(),r=s.get("name"),n=s.get("email"),u=s.get("message"),p="true"===s.get("isAnonymous");if(!u||!n)return a.NextResponse.json({success:!1,error:"Message and email are required"},{status:400});if(0===u.trim().length)return a.NextResponse.json({success:!1,error:"Message cannot be empty"},{status:400});let c=s.getAll("images");if(c.length>0&&c[0].size>0){let e=c[0];if(e.size>5242880)return a.NextResponse.json({success:!1,error:"Image size must be less than 5MB"},{status:400});if(!e.type.startsWith("image/"))return a.NextResponse.json({success:!1,error:"Please select a valid image file"},{status:400});try{let s=await e.arrayBuffer(),r=Buffer.from(s).toString("base64");t=`data:${e.type};base64,${r}`}catch(e){return a.NextResponse.json({success:!1,error:"Failed to process image"},{status:500})}}let m={message:u.trim(),name:p?"Anonymous":r?.trim()||"Anonymous",email:n.trim(),isAnonymous:p,timestamp:i.FieldValue.serverTimestamp(),createdAt:new Date().toISOString(),submittedAt:new Date().toISOString(),isApproved:!1,notificationSent:!1};t&&(m.imageUrl=t);let l=await o.db.collection("responses").add(m);return a.NextResponse.json({success:!0,message:"Thank you for your message! It has been received and will be reviewed for approval.",id:l.id})}catch(e){return console.error("Error processing form submission:",e),a.NextResponse.json({success:!1,error:"Failed to process submission"},{status:500})}}[o,i]=n.then?(await n)():n,r()}catch(e){r(e)}})},7096:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.d(t,{db:()=>u});var a=s(3263),o=s(2929),i=e([a,o]);[a,o]=i.then?(await i)():i;let n={type:"service_account",project_id:process.env.FIREBASE_PROJECT_ID,private_key_id:process.env.FIREBASE_PRIVATE_KEY_ID,private_key:process.env.FIREBASE_PRIVATE_KEY?.replace(/\\n/g,"\n"),client_email:process.env.FIREBASE_CLIENT_EMAIL,client_id:process.env.FIREBASE_CLIENT_ID,auth_uri:"https://accounts.google.com/o/oauth2/auth",token_uri:"https://oauth2.googleapis.com/token",auth_provider_x509_cert_url:"https://www.googleapis.com/oauth2/v1/certs",client_x509_cert_url:`https://www.googleapis.com/robot/v1/metadata/x509/${process.env.FIREBASE_CLIENT_EMAIL}`};(0,a.getApps)().length||(0,a.initializeApp)({credential:(0,a.cert)(n)});let u=(0,o.getFirestore)();r()}catch(e){r(e)}})}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[276,972],()=>s(809));module.exports=r})();